# متابعة اعتمادات عروض الأسعار للعملاء

## الغرض
متابعة حالة اعتماد عروض الأسعار المرسلة للعملاء وتحويلها إلى اتفاقيات بيع ومستندات تنفيذ أخرى.

## كيفية الاستخدام

### 1. الوصول للشاشة
- من القائمة الرئيسية، اختر **التقارير**
- ثم اختر **تقارير دورة المبيعات**
- اضغط على **متابعة اعتمادات عروض الأسعار للعملاء**

### 2. تحديد معايير البحث
في أعلى الشاشة ستجد مجموعة من الحقول لتحديد معايير البحث:

#### حقول إلزامية:
- **الفترة الزمنية**: اختر من تاريخ - إلى تاريخ
- **الموقع**: اختر الموقع أو المتجر المطلوب

#### حقول اختيارية:
- **العميل**: يمكن تحديد عميل معين أو تركها فارغة لجميع العملاء
- **حالة الاعتماد**: (معتمد، في انتظار الاعتماد، مرفوض)
- **نوع المستند**: (عرض أسعار، اتفاقية بيع، بيان تسليم)

### 3. عرض النتائج
- اضغط على زر **عرض** لتحميل البيانات
- ستظهر النتائج في جدول أسفل الشاشة
- يمكن تصفية النتائج باستخدام شريط البحث في أعلى الجدول

### 4. تصفح النتائج
- استخدم أزرار التنقل في أسفل الجدول للانتقال بين الصفحات
- يمكن تغيير عدد النتائج المعروضة في الصفحة الواحدة
- اضغط على أي صف لعرض تفاصيل إضافية

## مكونات الصفحة

### 1. شريط العنوان
- **عنوان التقرير**: "متابعة اعتمادات عروض الأسعار للعملاء"
- **تاريخ التقرير**: يظهر تاريخ ووقت إنشاء التقرير
- **اسم المستخدم**: يظهر اسم المستخدم الحالي

### 2. منطقة معايير البحث
```
┌─────────────────────────────────────────────────────────┐
│ معايير البحث                                            │
├─────────────────────────────────────────────────────────┤
│ الفترة: [من تاريخ] [إلى تاريخ]     الموقع: [قائمة منسدلة] │
│ العميل: [قائمة منسدلة]    حالة الاعتماد: [قائمة منسدلة] │
│ نوع المستند: [قائمة منسدلة]                            │
└─────────────────────────────────────────────────────────┘
```

### 3. أزرار التحكم
```
┌─────────────────────────────────────────────────────────┐
│ [عرض] [تصدير Excel] [تصدير PDF] [طباعة] [إعادة تعيين] │
└─────────────────────────────────────────────────────────┘
```

### 4. جدول النتائج
```
┌─────────────────────────────────────────────────────────┐
│ شريط البحث: [بحث في النتائج...]                        │
├─────────────────────────────────────────────────────────┤
│ اسم السند │ رقم السند │ تاريخ السند │ السعر │ العميل │
├─────────────────────────────────────────────────────────┤
│ عرض أسعار │ A-001     │ 2024-01-15  │ 5000  │ أحمد   │
│ اتفاقية   │ B-002     │ 2024-01-16  │ 3000  │ محمد   │
└─────────────────────────────────────────────────────────┘
```

### 5. شريط التنقل
```
┌─────────────────────────────────────────────────────────┐
│ عرض 10 من 150 نتيجة    [السابق] [1] [2] [3] [التالي] │
└─────────────────────────────────────────────────────────┘
```

## الأعمدة

| العمود | الوصف |
|--------|-------|
| اسم السند / نوع المستند | نوع المستند المرتبط بعرض السعر (مثل اتفاقية بيع، بيان تسليم). |
| رقم السند | الرقم التسلسلي للمستند. |
| تاريخ السند | تاريخ إصدار المستند. |
| السعر | قيمة عرض السعر أو المستند المرتبط. |
| اسم العميل | اسم العميل الذي صدر له العرض. |
| الموقع | الموقع أو المتجر الذي صدر منه العرض. |
| اعتماد عرض الأسعار | حالة أو رقم اعتماد العرض من الإدارة أو العميل. |
| اتفاقية بيع | رقم الاتفاقية التي تحوّل إليها العرض. |
| بيان تسليم | رقم بيان التسليم الناتج عن الاتفاقية. |
| مرتجع من بيان تسليم | رقم مستند المرتجع إن تمت إعادة جزء من البضاعة. |
| فاتورة مرحلية | رقم الفاتورة المرحلية الصادرة. |
| سند قبض | رقم سند القبض المتعلق بتحصيل دفعة. |
| مرتجع من فاتورة المبيعات | رقم مستند المرتجع من الفاتورة. |
| فاتورة مرتجع المبيعات | رقم فاتورة المرتجع. |
| إشعار مدين للعميل | رقم إشعار الزيادة (رسوم إضافية). |
| إشعار دائن للعميل | رقم إشعار الخصم. |
| مرجع | ملاحظات أو مرجع داخلي آخر. |

## أزرار التحكم

### زر "عرض"
- **الوظيفة**: تحميل وعرض البيانات حسب المعايير المحددة
- **الاستخدام**: اضغط بعد تحديد معايير البحث
- **النتيجة**: ظهور النتائج في الجدول

### زر "تصدير Excel"
- **الوظيفة**: تصدير النتائج إلى ملف Excel
- **الاستخدام**: اضغط لتحميل الملف
- **النتيجة**: ملف Excel يحتوي على جميع البيانات المعروضة

### زر "تصدير PDF"
- **الوظيفة**: تصدير النتائج إلى ملف PDF
- **الاستخدام**: اضغط لتحميل الملف
- **النتيجة**: ملف PDF منسق يحتوي على التقرير

### زر "طباعة"
- **الوظيفة**: طباعة التقرير مباشرة
- **الاستخدام**: اضغط لفتح نافذة الطباعة
- **النتيجة**: طباعة التقرير على الطابعة المحددة

### زر "إعادة تعيين"
- **الوظيفة**: مسح جميع معايير البحث
- **الاستخدام**: اضغط لاستعادة الحقول إلى حالتها الافتراضية
- **النتيجة**: مسح جميع الحقول وإعادة تعيينها

## الميزات الإضافية

### 1. البحث في النتائج
- **الموقع**: شريط البحث أعلى الجدول
- **الاستخدام**: اكتب أي كلمة للبحث في جميع الأعمدة
- **النتيجة**: تصفية النتائج تلقائياً

### 2. ترتيب الأعمدة
- **الاستخدام**: اضغط على عنوان العمود لترتيب النتائج
- **النتيجة**: ترتيب تصاعدي أو تنازلي حسب العمود

### 3. تصفية متقدمة
- **الاستخدام**: اضغط على أيقونة التصفية بجانب عنوان العمود
- **النتيجة**: خيارات تصفية إضافية للعمود المحدد

### 4. تصدير محدد
- **الاستخدام**: حدد صفوف معينة ثم اضغط تصدير
- **النتيجة**: تصدير البيانات المحددة فقط

## نصائح للاستخدام

### 1. للحصول على نتائج أسرع
- حدد فترة زمنية قصيرة
- اختر موقع محدد
- استخدم معايير تصفية إضافية

### 2. للتحليل الشامل
- اترك حقول العميل وحالة الاعتماد فارغة
- اختر فترة زمنية طويلة
- استخدم تصدير Excel للتحليل المتقدم

### 3. للمتابعة اليومية
- استخدم تاريخ اليوم فقط
- ركز على حالة "في انتظار الاعتماد"
- استخدم تصفية حسب العميل

## استكشاف الأخطاء

### مشكلة: لا تظهر نتائج
- **الحل**: تأكد من تحديد الفترة الزمنية والموقع
- **الحل**: تحقق من وجود بيانات في الفترة المحددة

### مشكلة: بطء في التحميل
- **الحل**: قلل الفترة الزمنية
- **الحل**: أضف معايير تصفية إضافية

### مشكلة: خطأ في التصدير
- **الحل**: تأكد من وجود نتائج للتصدير
- **الحل**: تحقق من صلاحيات الملفات في النظام

## الربط الخلفي
`Shared.API/Controllers/Reports/CustomerPricingApprovalsController`
